<!DOCTYPE html>
<!-- saved from url=(0037)http://www.jianshu.com/p/cc2281b1a6bc -->
<html class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
<script type="text/javascript" src="./LinkedBlockingQueue源码分析 - 简书_files/1255494d3a"></script><script src="./LinkedBlockingQueue源码分析 - 简书_files/nr-998.min.js.download"></script><script src="./LinkedBlockingQueue源码分析 - 简书_files/push.js.download"></script><script async="" src="./LinkedBlockingQueue源码分析 - 简书_files/analytics.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"1255494d3a","applicationID":"15702971","transactionName":"e1daR0JWVV9RER9ZWkxdRxxDUVZE","queueTime":56,"applicationTime":196,"agent":""}</script>
<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var o=t[n]={exports:{}};e[n][0].call(o.exports,function(t){var o=e[n][1][t];return r(o||t)},o,o.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){function r(){}function o(e,t,n){return function(){return i(e,[(new Date).getTime()].concat(u(arguments)),t?null:this,n),t?void 0:this}}var i=e("handle"),a=e(2),u=e(3),c=e("ee").get("tracer"),f=NREUM;"undefined"==typeof window.newrelic&&(newrelic=f);var s=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit"],l="api-",p=l+"ixn-";a(s,function(e,t){f[t]=o(l+t,!0,"api")}),f.addPageAction=o(l+"addPageAction",!0),f.setCurrentRouteName=o(l+"routeName",!0),t.exports=newrelic,f.interaction=function(){return(new r).get()};var d=r.prototype={createTracer:function(e,t){var n={},r=this,o="function"==typeof t;return i(p+"tracer",[Date.now(),e,n],r),function(){if(c.emit((o?"":"no-")+"fn-start",[Date.now(),r,o],n),o)try{return t.apply(this,arguments)}finally{c.emit("fn-end",[Date.now()],n)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){d[t]=o(p+t)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,(new Date).getTime()])}},{}],2:[function(e,t,n){function r(e,t){var n=[],r="",i=0;for(r in e)o.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],3:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(o<0?0:o);++r<o;)i[r]=e[t+r];return i}t.exports=r},{}],ee:[function(e,t,n){function r(){}function o(e){function t(e){return e&&e instanceof r?e:e?c(e,u,i):i()}function n(n,r,o){if(!p.aborted){e&&e(n,r,o);for(var i=t(o),a=v(n),u=a.length,c=0;c<u;c++)a[c].apply(i,r);var f=s[w[n]];return f&&f.push([y,n,r,i]),i}}function d(e,t){b[e]=v(e).concat(t)}function v(e){return b[e]||[]}function g(e){return l[e]=l[e]||o(n)}function m(e,t){f(e,function(e,n){t=t||"feature",w[n]=t,t in s||(s[t]=[])})}var b={},w={},y={on:d,emit:n,get:g,listeners:v,context:t,buffer:m,abort:a,aborted:!1};return y}function i(){return new r}function a(){(s.api||s.feature)&&(p.aborted=!0,s=p.backlog={})}var u="nr@context",c=e("gos"),f=e(2),s={},l={},p=t.exports=o();p.backlog=s},{}],gos:[function(e,t,n){function r(e,t,n){if(o.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){o.buffer([e],r),o.emit(e,t,n)}var o=e("ee").get("handle");t.exports=r,r.ee=o},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!h++){var e=y.info=NREUM.info,t=l.getElementsByTagName("script")[0];if(setTimeout(f.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return f.abort();c(b,function(t,n){e[t]||(e[t]=n)}),u("mark",["onload",a()],null,"api");var n=l.createElement("script");n.src="https://"+e.agent,t.parentNode.insertBefore(n,t)}}function o(){"complete"===l.readyState&&i()}function i(){u("mark",["domContent",a()],null,"api")}function a(){return(new Date).getTime()}var u=e("handle"),c=e(2),f=e("ee"),s=window,l=s.document,p="addEventListener",d="attachEvent",v=s.XMLHttpRequest,g=v&&v.prototype;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:v,REQ:s.Request,EV:s.Event,PR:s.Promise,MO:s.MutationObserver},e(1);var m=""+location,b={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-998.min.js"},w=v&&g&&g[p]&&!/CriOS/.test(navigator.userAgent),y=t.exports={offset:a(),origin:m,features:{},xhrWrappable:w};l[p]?(l[p]("DOMContentLoaded",i,!1),s[p]("load",r,!1)):(l[d]("onreadystatechange",o),s[d]("onload",r)),u("mark",["firstbyte",a()],null,"api");var h=0},{}]},{},["loader"]);</script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="description" content="前言在前面的文章ArrayBlockingQueue源码分析中，已经对JDK中的BlockingQueue中的做了一个回顾，同时对ArrayBlockingQueue中的核心方法作了说明，而LinkedBlockingQueue作为JDK中BlockingQueue家族系列中一员，由于其作为固定大小线程池(Executors.newFixedThreadPool())底层所使用的阻塞队列，分析它的目的主要在于2点：(1)与ArrayBlockingQueue进行类比学习，加深各种数据结构的理解(2)了解底层实现，能够更好地理解每一种阻塞队列对线程池性能的影响，做到真正的...">
  <meta property="wb:webmaster" content="294ec9de89e7fadb">
  <meta property="qc:admins" content="104102651453316562112116375">
  <meta property="qc:admins" content="11635613706305617">
  <meta property="qc:admins" content="1163561616621163056375">
  <meta name="google-site-verification" content="cV4-qkUJZR6gmFeajx_UyPe47GW9vY6cnCrYtCHYNh4">
  <meta name="google-site-verification" content="HF7lfF8YEGs1qtCE-kPml8Z469e2RHhGajy6JPVy5XI">
  <meta http-equiv="mobile-agent" content="format=html5; url=http://www.jianshu.com/p/cc2281b1a6bc">
    <!--  Meta for Smart App Banner -->
  <meta name="apple-itunes-app" content="app-id=888237539, app-argument=jianshu://notes/3293451">
  <!-- End -->

  <!--  Meta for Twitter Card -->
  <meta content="summary" property="twitter:card">
  <meta content="@jianshucom" property="twitter:site">
  <meta content=" LinkedBlockingQueue源码分析" property="twitter:title">
  <meta content="前言在前面的文章ArrayBlockingQueue源码分析中，已经对JDK中的BlockingQueue中的做了一个回顾，同时对ArrayBlockingQueue中的核心方法作了说明，而LinkedBlockingQueue作为JDK中BlockingQueue家族系列中一员，由于其作为固定大小线程池(Executors.newFixedThreadPool())底层所使用的阻塞队列，分析它的目的主要在于2点：(1)与ArrayBlockingQueue进行类比学习，加深各种数据结构的理解(2)了解底层实现，能够更好地理解每一种阻塞队列对线程池性能的影响，做到真正的..." property="twitter:description">
  <meta content="http://www.jianshu.com/p/cc2281b1a6bc" property="twitter:url">
  <!-- End -->

  <!--  Meta for OpenGraph -->
  <meta property="fb:app_id" content="865829053512461">
  <meta property="og:site_name" content="简书">
  <meta property="og:title" content=" LinkedBlockingQueue源码分析">
  <meta property="og:type" content="article">
  <meta property="og:url" content="http://www.jianshu.com/p/cc2281b1a6bc">
  <meta property="og:description" content="前言在前面的文章ArrayBlockingQueue源码分析中，已经对JDK中的BlockingQueue中的做了一个回顾，同时对ArrayBlockingQueue中的核心方法作了说明，而Li...">
  <!-- End -->

  <!--  Meta for Facebook Applinks -->
  <meta property="al:ios:url" content="jianshu://notes/3293451">
  <meta property="al:ios:app_store_id" content="888237539">
  <meta property="al:ios:app_name" content="简书">

  <meta property="al:android:url" content="jianshu://notes/3293451">
  <meta property="al:android:package" content="com.jianshu.haruki">
  <meta property="al:android:app_name" content="简书">
  <!-- End -->

  <title> LinkedBlockingQueue源码分析 - 简书</title>
  <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="GHYUmGlOhcMhfn8GPR18ZRNJj60fGxz051Ky7Pqw/uGhsexVTd1zxS+gLq/YypeKNb2dD/oU1tOIM16mXl4peg==">
  <!--[if lte IE 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" media="all" href="./LinkedBlockingQueue源码分析 - 简书_files/base-00828532d00225531ad20ff45bf311ea.css">

    <link rel="stylesheet" media="all" href="./LinkedBlockingQueue源码分析 - 简书_files/reading-note-a4d1e4bd26d83f631d58a76778118af6.css">
  <link rel="stylesheet" media="all" href="./LinkedBlockingQueue源码分析 - 简书_files/base-read-mode-5f4051bc94fc595e8bc00821aae6c3e1.css">
  <script src="./LinkedBlockingQueue源码分析 - 简书_files/modernizr-613ea63b5aa2f0e2a1946e9c28c8eedb.js.download"></script>
  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if IE 8]><link rel="stylesheet" media="all" href="http://cdn-qn0.jianshu.io/assets/scaffolding/for_ie-7f1c477ffedc13c11315103e8787dc6c.css" /><![endif]-->
  <!--[if lt IE 9]><link rel="stylesheet" media="all" href="http://cdn-qn0.jianshu.io/assets/scaffolding/for_ie-7f1c477ffedc13c11315103e8787dc6c.css" /><![endif]-->
  <link href="http://baijii-common.b0.upaiyun.com/icons/favicon.ico" rel="icon">
      <link rel="apple-touch-icon-precomposed" href="http://cdn-qn0.jianshu.io/assets/apple-touch-icons/57-b426758a1fcfb30486f20fd073c3b8ec.png" sizes="57x57">
      <link rel="apple-touch-icon-precomposed" href="http://cdn-qn0.jianshu.io/assets/apple-touch-icons/72-feca4b183b9d29fd188665785dc7a7f1.png" sizes="72x72">
      <link rel="apple-touch-icon-precomposed" href="http://cdn-qn0.jianshu.io/assets/apple-touch-icons/76-ba757f1ad3421192ce7192170393d2b0.png" sizes="76x76">
      <link rel="apple-touch-icon-precomposed" href="http://cdn-qn0.jianshu.io/assets/apple-touch-icons/114-8dae53b3bcea3f06bb139e329d1edab3.png" sizes="114x114">
      <link rel="apple-touch-icon-precomposed" href="http://cdn-qn0.jianshu.io/assets/apple-touch-icons/120-fa315ee0177dba4c55d4f66d4129b47f.png" sizes="120x120">
      <link rel="apple-touch-icon-precomposed" href="http://cdn-qn0.jianshu.io/assets/apple-touch-icons/152-052f5799bec8fb3aa624bdc72ef5bd1d.png" sizes="152x152">

<style type="text/css"></style></head>

<body class="post output zh cn win reader-day-mode reader-font2" data-js-module="note-show" data-locale="zh-CN">
  
  <div class="navbar navbar-jianshu shrink">
  <div class="dropdown">
    <a class="dropdown-toggle logo" id="dLabel" role="button" data-toggle="dropdown" data-target="#" href="javascript:void(0)">
      简
    </a>
    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
      <li><a href="http://www.jianshu.com/"><i class="fa fa-home"></i> 首页</a></li>
      <li><a href="http://www.jianshu.com/collections"><i class="fa fa-th"></i> 专题</a></li>
    </ul>
  </div>
</div>
<div class="navbar-user">
    <a class="app-download-btn" href="http://www.jianshu.com/apps/download?utm_medium=top-sugg-down&amp;utm_source=web-other-page">App下载</a>
    <a class="login" data-signup-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_up">
      <i class="fa fa-user"></i> 注册
</a>    <a class="login" data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in">
      <i class="fa fa-sign-in"></i> 登录
</a>    <a class="daytime set-view-mode pull-right" href="javascript:void(0)"><i class="fa fa-moon-o"></i></a>
</div>
<div class="navbar navbar-jianshu expanded">
  <div class="dropdown">
      <a class="active logo" role="button" data-original-title="个人主页" data-container="div.expanded" href="http://www.jianshu.com/">
        <b>简</b><i class="fa fa-home"></i><span class="title">首页</span>
</a>      <a data-toggle="tooltip" data-placement="right" data-original-title="专题" data-container="div.expanded" href="http://www.jianshu.com/collections">
        <i class="fa fa-th"></i><span class="title">专题</span>
</a>    <a class="ad-selector" href="http://www.jianshu.com/apps">
      <i class="fa fa-mobile"></i><span class="title">下载手机应用</span>
</a>    <div class="ad-container ">
      <div class="ad-pop">
        <img class="ad-logo" src="./LinkedBlockingQueue源码分析 - 简书_files/228-0765f118055a1d942fc286fb55f37773.png" alt="228">
        <p class="ad-title">简书</p>
        <p class="ad-subtitle">交流故事，沟通想法</p>
        <img class="ad-qrcode" src="./LinkedBlockingQueue源码分析 - 简书_files/download-app-qrcode-053849fa25f9b44573ef8dd3c118a20f.png" alt="Download app qrcode">
        <div>
          <a class="ad-link" href="https://itunes.apple.com/cn/app/jian-shu/id888237539?ls=1&amp;mt=8">iOS</a>·
          <a class="ad-link" href="http://downloads.jianshu.io/apps/haruki/JianShu-1.11.5.apk">Android</a>
        </div>
      </div>
    </div>
  </div>
  <div class="nav-user">
      <a href="http://www.jianshu.com/p/cc2281b1a6bc#view-mode-modal" data-toggle="modal"><i class="fa fa-font"></i><span class="title">显示模式</span></a>

      <a class="signin" data-signin-link="true" data-toggle="modal" data-placement="right" data-original-title="登录" data-container="div.expanded" href="http://www.jianshu.com/sign_in">
        <i class="fa fa-sign-in"></i><span class="title">登录</span>
</a>    </div>
  </div>

  
      <div class="popover-wrap">
       <div class="fixed-btn note-fixed-download" data-toggle="popover" data-placement="left" data-html="true" data-trigger="hover" data-content="&lt;img src=&quot;http://cdn-qn0.jianshu.io/assets/app-page/note-qrcode-599086b03613e4f65dce8698fe9bcc99.png&quot; alt=&quot;Note qrcode&quot; /&gt;" data-original-title="" title="">
        <a class="qrcode" href="javascript:void(0)">
          <img src="./LinkedBlockingQueue源码分析 - 简书_files/icon_qrcode-1f27688ec77df5a8c6c6ea70aa181874.png" alt="Icon qrcode">
          <div>简书手机版下载</div>
</a>      </div>
    </div>
    <div class="fixed-btn">
      <a class="go-top hide-go-top" href="http://www.jianshu.com/p/cc2281b1a6bc#"> <i class="fa fa-angle-up"></i></a>
      <a class="writer" href="http://www.jianshu.com/writer#/" data-toggle="tooltip" data-placement="left" title="" data-original-title="写篇文章"><i class="fa fa-pencil"></i></a>
    </div>


  <div id="show-note-container" class="imagebubble-container imagebubble-mode-off">
    
<div class="post-bg" id="flag">
  <div class="wrap-btn">
    <!-- Notebook and collections button upper left -->
      <div class="article-related pull-left">
          <a class="collection-menu-btn" data-toggle="modal" data-target="#collection-menu" href="javascript:void(null);">
            <i class="fa fa-th"></i>
</a>          <a class="notebooks-menu-btn" data-toggle="modal" data-target="#notebooks-menu" href="javascript:void(null);"><i class="fa fa-list-ul"></i></a>
        <div class="related-avatar-group activities"></div>
      </div>
    <!-- ******* -->

      <a class="app-download-btn" href="http://www.jianshu.com/apps/download?utm_medium=top-sugg-down&amp;utm_source=note-show">App下载</a>
  <a class="login" data-signup-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_up">
    <i class="fa fa-user"></i> 注册
</a>  <a class="login" data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in">
    <i class="fa fa-sign-in"></i> 登录
</a>

    <!-- Buttons upper right -->
    <!-- ******* -->
  </div>

  <div class="container">
    <!-- Article activities for width under 768px -->
    <div class="related-avatar-group activities"></div>
      <div class="article">
        <div class="preview">
          <div class="author-info">
              <div class="btn btn-small btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in"><i class="fa fa-plus"></i>  <span>添加关注</span></a>
  </div>

            <a class="avatar" href="http://www.jianshu.com/users/dc9be3b69337">
              <img src="./LinkedBlockingQueue源码分析 - 简书_files/675ca95f25be.png" alt="100">
</a>            <span class="label">
                作者
            </span>
            <a class="author-name blue-link" href="http://www.jianshu.com/users/dc9be3b69337">
              <span>码农一枚</span>
</a>              <span data-toggle="tooltip" data-original-title="最后编辑于 2016.03.19 12:41">2016.03.19 12:38*</span>
            <div>
              <span>写了31964字</span>，<span>被110人关注</span>，<span>获得了97个喜欢</span>
            </div>
          </div>
          <h1 class="title"> LinkedBlockingQueue源码分析</h1>
          <div class="meta-top">
            <span class="wordage">字数3958</span>
            <span class="views-count">阅读399</span>
            <span class="comments-count">评论0</span>
            <span class="likes-count">喜欢4</span>
          </div>

          <!-- Collection/Bookmark/Share for width under 768px -->
          <div class="article-share"><a class="bookmark" data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in"> <i class="fa fa-bookmark-o"></i><span>收藏文章</span></a><span> <a href="javascript:void(null)" data-toggle="dropdown"><i class="fa fa-share-square-o"></i> 分享</a> <ul class="dropdown-menu arrow-top"> <li> <a href="javascript:void((function(s,d,e,r,l,p,t,z,c){var%20f=&#39;http://v.t.sina.com.cn/share/share.php?appkey=1881139527&#39;,u=z||d.location,p=[&#39;&amp;url=&#39;,e(u),&#39;&amp;title=&#39;,e(t||d.title),&#39;&amp;source=&#39;,e(r),&#39;&amp;sourceUrl=&#39;,e(l),&#39;&amp;content=&#39;,c||&#39;gb2312&#39;,&#39;&amp;pic=&#39;,e(p||&#39;&#39;)].join(&#39;&#39;);function%20a(){if(!window.open([f,p].join(&#39;&#39;),&#39;mb&#39;,[&#39;toolbar=0,status=0,resizable=1,width=440,height=430,left=&#39;,(s.width-440)/2,&#39;,top=&#39;,(s.height-430)/2].join(&#39;&#39;)))u.href=[f,p].join(&#39;&#39;);};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,&#39;&#39;,&#39;&#39;,&#39;http://cwb.assets.jianshu.io/notes/images/3293451/weibo/image_08afaaf98e0c.jpg&#39;, &#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》（ 分享自 @简书 ）&#39;,&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;,&#39;页面编码gb2312|utf-8默认gb2312&#39;));"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/weibo.png"> </a> </li> <li> <a href="javascript:void(function(){var d=document,e=encodeURIComponent,s1=window.getSelection,s2=d.getSelection,s3=d.selection,s=s1?s1():s2?s2():s3?s3.createRange().text:&#39;&#39;,r=&#39;http://www.douban.com/recommend/?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;title=&#39;+e(&#39; LinkedBlockingQueue源码分析&#39;)+&#39;&amp;sel=&#39;+e(s)+&#39;&amp;v=1&#39;,x=function(){if(!window.open(r,&#39;douban&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r+&#39;&amp;r=1&#39;};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})()"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/douban.png"> </a> </li> <li> <a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》（ 分享自 @jianshuio ）&#39;),x=function(){if(!window.open(r,&#39;tweibo&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/tweibo.png"> </a> </li> <li> <a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》&#39;),x=function(){if(!window.open(r,&#39;qzone&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/qzone.png"> </a> </li> <li> <a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://twitter.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;text=&#39;+e(&#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》（ 分享自 @jianshucom ）&#39;)+&#39;&amp;related=&#39;+e(&#39;jianshucom&#39;),x=function(){if(!window.open(r,&#39;twitter&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/twitter.png"> </a> </li> <li> <a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://www.facebook.com/dialog/share?app_id=483126645039390&amp;display=popup&amp;href=http://www.jianshu.com/p/cc2281b1a6bc&#39;,x=function(){if(!window.open(r,&#39;facebook&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/facebook.png"> </a> </li> <li> <a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://plus.google.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;),x=function(){if(!window.open(r,&#39;google_plus&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/google_plus.png"> </a> </li> <li> <a href="http://www.jianshu.com/p/cc2281b1a6bc"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/renren.png"> </a> </li> </ul></span></div>
          <!-- -->

          <div class="show-content"><h3>前言</h3>
<p>在前面的文章<a href="http://www.jianshu.com/p/9a652250e0d1" target="_blank">ArrayBlockingQueue源码分析</a>中，已经对JDK中的BlockingQueue中的做了一个回顾，同时对ArrayBlockingQueue中的核心方法作了说明，而LinkedBlockingQueue作为JDK中BlockingQueue家族系列中一员，由于其作为固定大小线程池(Executors.newFixedThreadPool())底层所使用的阻塞队列，分析它的目的主要在于2点：<br>(1) 与ArrayBlockingQueue进行类比学习，加深各种数据结构的理解<br>(2) 了解底层实现，能够更好地理解每一种阻塞队列对线程池性能的影响，做到真正的知其然，且知其所以然</p>
<ul>
<li>源码分析LinkedBlockingQueue的实现</li>
<li>与ArrayBlockingQueue进行比较</li>
<li>说明为什么选择LinkedBlockingQueue作为固定大小的线程池的阻塞队列<br><strong>如发现有分析不对或不准确的地方，请您及时纠正(在此谢过)</strong>
</li>
</ul>
<h2>1.LinkedBlockingQueue深入分析</h2>
<p>LinkedBlockingQueue，见名之意，它是由一个基于链表的阻塞队列，首先看一下的核心组成：</p>
<pre class="hljs java"><code class="java">    <span class="hljs-comment">// 所有的元素都通过Node这个静态内部类来进行存储，这与LinkedList的处理方式完全一样</span>
    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>&lt;<span class="hljs-title">E</span>&gt; </span>{
        <span class="hljs-comment">//使用item来保存元素本身</span>
        E item;
        <span class="hljs-comment">//保存当前节点的后继节点</span>
        Node&lt;E&gt; next;
        Node(E x) { item = x; }
    }
    <span class="hljs-comment">/**
        阻塞队列所能存储的最大容量
        用户可以在创建时手动指定最大容量,如果用户没有指定最大容量
        那么最默认的最大容量为Integer.MAX_VALUE.
    */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> capacity;

    <span class="hljs-comment">/** 
        当前阻塞队列中的元素数量
        PS:如果你看过ArrayBlockingQueue的源码,你会发现
        ArrayBlockingQueue底层保存元素数量使用的是一个
        普通的int类型变量。其原因是在ArrayBlockingQueue底层
        对于元素的入队列和出队列使用的是同一个lock对象。而数
        量的修改都是在处于线程获取锁的情况下进行操作，因此不
        会有线程安全问题。
        而LinkedBlockingQueue却不是，它的入队列和出队列使用的是两个    
        不同的lock对象,因此无论是在入队列还是出队列，都会涉及对元素数
        量的并发修改，(之后通过源码可以更加清楚地看到)因此这里使用了一个原子操作类
        来解决对同一个变量进行并发修改的线程安全问题。
    */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AtomicInteger count = <span class="hljs-keyword">new</span> AtomicInteger(<span class="hljs-number">0</span>);

    <span class="hljs-comment">/**
     * 链表的头部
     * LinkedBlockingQueue的头部具有一个不变性:
     * 头部的元素总是为null，head.item==null   
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> Node&lt;E&gt; head;

    <span class="hljs-comment">/**
     * 链表的尾部
     * LinkedBlockingQueue的尾部也具有一个不变性:
     * 即last.next==null
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> Node&lt;E&gt; last;

    <span class="hljs-comment">/**
     元素出队列时线程所获取的锁
     当执行take、poll等操作时线程需要获取的锁
    */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantLock takeLock = <span class="hljs-keyword">new</span> ReentrantLock();

    <span class="hljs-comment">/**
    当队列为空时，通过该Condition让从队列中获取元素的线程处于等待状态
    */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notEmpty = takeLock.newCondition();

    <span class="hljs-comment">/** 
      元素入队列时线程所获取的锁
      当执行add、put、offer等操作时线程需要获取锁
    */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantLock putLock = <span class="hljs-keyword">new</span> ReentrantLock();

    <span class="hljs-comment">/** 
     当队列的元素已经达到capactiy，通过该Condition让元素入队列的线程处于等待状态
    */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notFull = putLock.newCondition();</code></pre>
<p>通过上面的分析，我们可以发现LinkedBlockingQueue在入队列和出队列时使用的不是同一个Lock，这也意味着它们之间的操作不会存在互斥操作。在多个CPU的情况下，它们可以做到真正的在同一时刻既消费、又生产，能够做到并行处理。</p>
<p>下面让我们看下LinkedBlockingQueue的构造方法：</p>
<pre class="hljs cs"><code class="cs">    <span class="hljs-comment">/**
     * 如果用户没有显示指定capacity的值，默认使用int的最大值
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LinkedBlockingQueue</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>(Integer.MAX_VALUE);
    }
    <span class="hljs-comment">/**
     可以看到,当队列中没有任何元素的时候,此时队列的头部就等于队列的尾部,
     指向的是同一个节点,并且元素的内容为null
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LinkedBlockingQueue</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> capacity</span>) </span>{
        <span class="hljs-keyword">if</span> (capacity &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException();
        <span class="hljs-keyword">this</span>.capacity = capacity;
        last = head = <span class="hljs-keyword">new</span> Node&lt;E&gt;(<span class="hljs-keyword">null</span>);
    }

    <span class="hljs-comment">/*
    在初始化LinkedBlockingQueue的时候，还可以直接将一个集合
    中的元素全部入队列，此时队列最大容量依然是int的最大值。
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LinkedBlockingQueue</span>(<span class="hljs-params">Collection&lt;? extends E&gt; c</span>) </span>{
        <span class="hljs-keyword">this</span>(Integer.MAX_VALUE);
        final ReentrantLock putLock = <span class="hljs-keyword">this</span>.putLock;
        <span class="hljs-comment">//获取锁</span>
        putLock.<span class="hljs-keyword">lock</span>(); <span class="hljs-comment">// Never contended, but necessary for visibility</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//迭代集合中的每一个元素,让其入队列,并且更新一下当前队列中的元素数量</span>
            <span class="hljs-keyword">int</span> n = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (E e : c) {
                <span class="hljs-keyword">if</span> (e == <span class="hljs-keyword">null</span>)
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();
                <span class="hljs-keyword">if</span> (n == capacity)
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">"Queue full"</span>);
                <span class="hljs-comment">//参考下面的enqueue分析        </span>
                enqueue(<span class="hljs-keyword">new</span> Node&lt;E&gt;(e));
                ++n;
            }
            count.<span class="hljs-keyword">set</span>(n);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">//释放锁</span>
            putLock.unlock();
        }
    }

    <span class="hljs-comment">/**
     * 我去，这代码其实可读性不怎么样啊。
     * 其实下面的代码等价于如下内容:
     * last.next=node;
     * last = node;
     * 其实也没有什么花样:
       就是让新入队列的元素成为原来的last的next，让进入的元素称为last
     *
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">enqueue</span>(<span class="hljs-params">Node&lt;E&gt; node</span>) </span>{
        <span class="hljs-comment">// assert putLock.isHeldByCurrentThread();</span>
        <span class="hljs-comment">// assert last.next == null;</span>
        last = last.next = node;
    }</code></pre>
<p>在分析完LinkedBlockingQueue的核心组成之后,下面让我们再看下核心的几个操作方法,首先分析一下元素入队列的过程:</p>
<pre class="hljs java"><code class="java">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">put</span><span class="hljs-params">(E e)</span> <span class="hljs-keyword">throws</span> InterruptedException </span>{
        <span class="hljs-keyword">if</span> (e == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();
        <span class="hljs-comment">// Note: convention in all put/take/etc is to preset local var</span>

        <span class="hljs-comment">/*注意上面这句话,约定所有的put/take操作都会预先设置本地变量,
        可以看到下面有一个将putLock赋值给了一个局部变量的操作
        */</span>
        <span class="hljs-keyword">int</span> c = -<span class="hljs-number">1</span>;
        Node&lt;E&gt; node = <span class="hljs-keyword">new</span> Node(e);
        <span class="hljs-comment">/* 
         在这里首先获取到putLock,以及当前队列的元素数量
         即上面所描述的预设置本地变量操作
        */</span>
        <span class="hljs-keyword">final</span> ReentrantLock putLock = <span class="hljs-keyword">this</span>.putLock;
        <span class="hljs-keyword">final</span> AtomicInteger count = <span class="hljs-keyword">this</span>.count;
        <span class="hljs-comment">/*
            执行可中断的锁获取操作,即意味着如果线程由于获取
            锁而处于Blocked状态时，线程是可以被中断而不再继
            续等待，这也是一种避免死锁的一种方式，不会因为
            发现到死锁之后而由于无法中断线程最终只能重启应用。
        */</span>
        putLock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">/*
            当队列的容量到底最大容量时,此时线程将处于等待状
            态，直到队列有空闲的位置才继续执行。使用while判
            断依旧是为了放置线程被"伪唤醒”而出现的情况,即当
            线程被唤醒时而队列的大小依旧等于capacity时，线
            程应该继续等待。
            */</span>
            <span class="hljs-keyword">while</span> (count.get() == capacity) {
                notFull.await();
            }
            <span class="hljs-comment">//让元素进行队列的末尾,enqueue代码在上面分析过了</span>
            enqueue(node);
            <span class="hljs-comment">//首先获取原先队列中的元素个数,然后再对队列中的元素个数+1.</span>
            c = count.getAndIncrement();
            <span class="hljs-comment">/*注:c+1得到的结果是新元素入队列之后队列元素的总和。
            当前队列中的总元素个数小于最大容量时,此时唤醒其他执行入队列的线程
            让它们可以放入元素,如果新加入元素之后,队列的大小等于capacity，
            那么就意味着此时队列已经满了,也就没有必须要唤醒其他正在等待入队列的线程,因为唤醒它们之后，它们也还是继续等待。
            */</span>
            <span class="hljs-keyword">if</span> (c + <span class="hljs-number">1</span> &lt; capacity)
                notFull.signal();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">//完成对锁的释放</span>
            putLock.unlock();
        }
        <span class="hljs-comment">/*当c=0时，即意味着之前的队列是空队列,出队列的线程都处于等待状态，
        现在新添加了一个新的元素,即队列不再为空,因此它会唤醒正在等待获取元素的线程。
        */</span>
        <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>)
            signalNotEmpty();
    }

    <span class="hljs-comment">/*
    唤醒正在等待获取元素的线程,告诉它们现在队列中有元素了
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">signalNotEmpty</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">final</span> ReentrantLock takeLock = <span class="hljs-keyword">this</span>.takeLock;
        takeLock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//通过notEmpty唤醒获取元素的线程</span>
            notEmpty.signal();
        } <span class="hljs-keyword">finally</span> {
            takeLock.unlock();
        }
    }</code></pre>
<p>看完put方法，下面再看看下offer是如何处理的方法：</p>
<pre class="hljs cs"><code class="cs">    <span class="hljs-comment">/**
    在BlockingQueue接口中除了定义put方法外(当队列元素满了之后就会阻塞，
    直到队列有新的空间可以方法线程才会继续执行)，还定义一个offer方法，
    该方法会返回一个boolean值，当入队列成功返回true,入队列失败返回false。
    该方法与put方法基本操作基本一致，只是有细微的差异。
    */</span>
     <span class="hljs-function"><span class="hljs-keyword">public</span> boolean <span class="hljs-title">offer</span>(<span class="hljs-params">E e</span>) </span>{
        <span class="hljs-keyword">if</span> (e == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();
        final AtomicInteger count = <span class="hljs-keyword">this</span>.count;
        <span class="hljs-comment">/*
            当队列已经满了，它不会继续等待,而是直接返回。
            因此该方法是非阻塞的。
        */</span>
        <span class="hljs-keyword">if</span> (count.<span class="hljs-keyword">get</span>() == capacity)
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        <span class="hljs-keyword">int</span> c = -<span class="hljs-number">1</span>;
        Node&lt;E&gt; node = <span class="hljs-keyword">new</span> Node(e);
        final ReentrantLock putLock = <span class="hljs-keyword">this</span>.putLock;
        putLock.<span class="hljs-keyword">lock</span>();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">/*
            当获取到锁时，需要进行二次的检查,因为可能当队列的大小为capacity-1时，
            两个线程同时去抢占锁，而只有一个线程抢占成功，那么此时
            当线程将元素入队列后，释放锁，后面的线程抢占锁之后，此时队列
            大小已经达到capacity，所以将它无法让元素入队列。
            下面的其余操作和put都一样，此处不再详述
            */</span>
            <span class="hljs-keyword">if</span> (count.<span class="hljs-keyword">get</span>() &lt; capacity) {
                enqueue(node);
                c = count.getAndIncrement();
                <span class="hljs-keyword">if</span> (c + <span class="hljs-number">1</span> &lt; capacity)
                    notFull.signal();
            }
        } <span class="hljs-keyword">finally</span> {
            putLock.unlock();
        }
        <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>)
            signalNotEmpty();
        <span class="hljs-keyword">return</span> c &gt;= <span class="hljs-number">0</span>;
    }</code></pre>
<p>BlockingQueue还定义了一个限时等待插入操作，即在等待一定的时间内，如果队列有空间可以插入，那么就将元素入队列，然后返回true,如果在过完指定的时间后依旧没有空间可以插入，那么就返回false，下面是限时等待操作的分析:</p>
<pre class="hljs java"><code class="java">        <span class="hljs-comment">/**
         通过timeout和TimeUnit来指定等待的时长
         timeout为时间的长度,TimeUnit为时间的单位
        */</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">offer</span><span class="hljs-params">(E e, <span class="hljs-keyword">long</span> timeout, TimeUnit unit)</span>
        <span class="hljs-keyword">throws</span> InterruptedException </span>{

        <span class="hljs-keyword">if</span> (e == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();
        <span class="hljs-comment">//将指定的时间长度转换为毫秒来进行处理</span>
        <span class="hljs-keyword">long</span> nanos = unit.toNanos(timeout);
        <span class="hljs-keyword">int</span> c = -<span class="hljs-number">1</span>;
        <span class="hljs-keyword">final</span> ReentrantLock putLock = <span class="hljs-keyword">this</span>.putLock;
        <span class="hljs-keyword">final</span> AtomicInteger count = <span class="hljs-keyword">this</span>.count;
        putLock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">while</span> (count.get() == capacity) {
                <span class="hljs-comment">//如果等待的剩余时间小于等于0，那么直接返回</span>
                <span class="hljs-keyword">if</span> (nanos &lt;= <span class="hljs-number">0</span>)
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
            <span class="hljs-comment">/*
              通过condition来完成等待，此时当前线程会完成锁的，并且处于等待状态
              直到被其他线程唤醒该线程、或者当前线程被中断、
              等待的时间截至才会返回，该返回值为从方法调用到返回所经历的时长。
              注意：上面的代码是condition的awitNanos()方法的通用写法，
              可以参看Condition.awaitNaos的API文档。
              下面的其余操作和put都一样，此处不再详述
            */</span>
                nanos = notFull.awaitNanos(nanos);
            }
            enqueue(<span class="hljs-keyword">new</span> Node&lt;E&gt;(e));
            c = count.getAndIncrement();
            <span class="hljs-keyword">if</span> (c + <span class="hljs-number">1</span> &lt; capacity)
                notFull.signal();
        } <span class="hljs-keyword">finally</span> {
            putLock.unlock();
        }
        <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>)
            signalNotEmpty();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }</code></pre>
<p>通过上面的分析，我们应该比较清楚地知道了LinkedBlockingQueue的入队列的操作，其主要是通过获取到putLock锁来完成，当队列的数量达到最大值，此时会导致线程处于阻塞状态或者返回false(根据具体的方法来看)；如果队列还有剩余的空间，那么此时会新创建出一个Node对象，将其设置到队列的尾部，作为LinkedBlockingQueue的last元素。</p>
<p>在分析完入队列的过程之后，我们接下来看看LinkedBlockingQueue出队列的过程；由于BlockingQueue的方法都具有对称性，此处就只分析take方法的实现，其余方法的实现都如出一辙：</p>
<pre class="hljs java"><code class="java"> <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">take</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException </span>{
        E x;
        <span class="hljs-keyword">int</span> c = -<span class="hljs-number">1</span>;
        <span class="hljs-keyword">final</span> AtomicInteger count = <span class="hljs-keyword">this</span>.count;
        <span class="hljs-keyword">final</span> ReentrantLock takeLock = <span class="hljs-keyword">this</span>.takeLock;
        <span class="hljs-comment">//通过takeLock获取锁，并且支持线程中断</span>
        takeLock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//当队列为空时，则让当前线程处于等待</span>
            <span class="hljs-keyword">while</span> (count.get() == <span class="hljs-number">0</span>) {
                notEmpty.await();
            }
            <span class="hljs-comment">//完成元素的出队列</span>
            x = dequeue();
            <span class="hljs-comment">/*            
               队列元素个数完成原子化操作-1,可以看到count元素会
               在插入元素的线程和获取元素的线程进行并发修改操作。
            */</span>
            c = count.getAndDecrement();
            <span class="hljs-comment">/*
              当一个元素出队列之后，队列的大小依旧大于1时
              当前线程会唤醒其他执行元素出队列的线程,让它们也
              可以执行元素的获取
            */</span>
            <span class="hljs-keyword">if</span> (c &gt; <span class="hljs-number">1</span>)
                notEmpty.signal();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">//完成锁的释放</span>
            takeLock.unlock();
        }
        <span class="hljs-comment">/*
            当c==capaitcy时，即在获取当前元素之前，
            队列已经满了，而此时获取元素之后，队列就会
            空出一个位置，故当前线程会唤醒执行插入操作的线
            程通知其他中的一个可以进行插入操作。
        */</span>
        <span class="hljs-keyword">if</span> (c == capacity)
            signalNotFull();
        <span class="hljs-keyword">return</span> x;
    }


    <span class="hljs-comment">/**
     * 让头部元素出队列的过程
     * 其最终的目的是让原来的head被GC回收，让其的next成为head
     * 并且新的head的item为null.
     * 因为LinkedBlockingQueue的头部具有一致性:即元素为null。
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> E <span class="hljs-title">dequeue</span><span class="hljs-params">()</span> </span>{
        Node&lt;E&gt; h = head;
        Node&lt;E&gt; first = h.next;
        h.next = h; <span class="hljs-comment">// help GC</span>
        head = first;
        E x = first.item;
        first.item = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">return</span> x;
    }</code></pre>
<div class="image-package imagebubble" widget="ImageBubble">
<img src="./LinkedBlockingQueue源码分析 - 简书_files/1684370-9bea30e290a8822c.png" data-original-src="http://upload-images.jianshu.io/upload_images/1684370-9bea30e290a8822c.png?imageMogr2/auto-orient/strip%7CimageView2/2" class="imagebubble-image"><br><div class="image-caption">LinkedBlockingQueue出队列大致过程.png</div>
</div>
<p>对于LinkedBlockingQueue的源码分析就到这里，下面让我们将LinkedBlockingQueue与ArrayBlockingQueue进行一个比较。</p>
<h2>2.LinkedBlockingQueue与ArrayBlockingQueue的比较</h2>
<p>ArrayBlockingQueue由于其底层基于数组，并且在创建时指定存储的大小，在完成后就会立即在内存分配固定大小容量的数组元素，因此其存储通常有限，故其是一个<strong>“有界“</strong>的阻塞队列；而LinkedBlockingQueue可以由用户指定最大存储容量，也可以无需指定，如果不指定则最大存储容量将是Integer.MAX_VALUE，即可以看作是一个<strong>“无界”</strong>的阻塞队列，由于其节点的创建都是动态创建，并且在节点出队列后可以被GC所回收，因此其具有灵活的伸缩性。但是由于ArrayBlockingQueue的有界性，因此其能够更好的对于性能进行预测，而LinkedBlockingQueue由于没有限制大小，当任务非常多的时候，不停地向队列中存储，就有可能导致内存溢出的情况发生。</p>
<p>其次，ArrayBlockingQueue中在入队列和出队列操作过程中，使用的是同一个lock，所以即使在多核CPU的情况下，其读取和操作的都无法做到并行，而LinkedBlockingQueue的读取和插入操作所使用的锁是两个不同的lock，它们之间的操作互相不受干扰，因此两种操作可以并行完成，故LinkedBlockingQueue的吞吐量要高于ArrayBlockingQueue。</p>
<h2>3.选择LinkedBlockingQueue的理由</h2>
<pre class="hljs cpp"><code class="cpp">    <span class="hljs-comment">/**
        下面的代码是Executors创建固定大小线程池的代码，其使用了
        LinkedBlockingQueue来作为任务队列。
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title">newFixedThreadPool</span><span class="hljs-params">(<span class="hljs-keyword">int</span> nThreads)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,
                                      <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,
                                      <span class="hljs-keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());
    }</code></pre>
<p>JDK中选用LinkedBlockingQueue作为阻塞队列的原因就在于其<strong>无界性</strong>。因为线程大小固定的线程池，其线程的数量是不具备伸缩性的，当任务非常繁忙的时候，就势必会导致所有的线程都处于工作状态，如果使用一个有界的阻塞队列来进行处理，那么就非常有可能很快导致队列满的情况发生，从而导致任务无法提交而抛出RejectedExecutionException，而使用无界队列由于其良好的存储容量的伸缩性，可以很好的去缓冲任务繁忙情况下场景，即使任务非常多，也可以进行动态扩容，当任务被处理完成之后，队列中的节点也会被随之被GC回收，非常灵活。</p>
<p>至此，LinkedBlockingQueue的分析就到这里，如果您发现有任何编写不对的地方，请指出(万分感谢！)。</p>
</div>
        </div>
      </div>

      <div class="visitor_edit">
        <!-- further readings -->
        <div id="further-readings" data-user-slug="" data-user-nickname="">
          <div id="further-reading-line" class="hide further-reading-line"></div>
          <ul id="further-readings-list" class="reading-list unstyled"></ul>
          <div id="further-reading-new" class="reading-edit">
              <a data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in">
                <i class="fa fa-plus-circle"></i> 推荐拓展阅读
</a>            <div id="further-reading-form"></div>
          </div>
        </div>
        <div class="pull-right">
          <!-- copyright -->
          <div class="author-copyright pull-right" data-toggle="tooltip" data-html="true" title="" data-original-title="转载请联系作者获得授权，并标注“简书作者”。">
            <a><i class="fa fa-copyright"></i> 著作权归作者所有</a>
          </div>
        </div>
      </div>

      <!-- Reward / Support Author -->
        <div class="support-author">
          <p>如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作！</p>
            <a class="btn btn-pay" data-toggle="modal" href="http://www.jianshu.com/p/cc2281b1a6bc#pay-modal">¥ 打赏支持</a>
          <div class="avatar-list"></div>
        </div>

      <!-- article meta bottom -->
      <div class="meta-bottom clearfix">
        <!--  Like Button -->
        <div class="like ">
            <div class="like-button">
              <a id="like-note" class="like-content" data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in">
                <i class="fa fa-heart-o"></i>  喜欢
</a></div>          <span id="likes-count" data-toggle="tooltip" data-placement="right" title="" data-original-title="查看所有喜欢的用户">4</span>        </div>
        <!--  share group -->
        <div class="share-group pull-right">
          <a href="javascript:void((function(s,d,e,r,l,p,t,z,c){var%20f=&#39;http://v.t.sina.com.cn/share/share.php?appkey=1881139527&#39;,u=z||d.location,p=[&#39;&amp;url=&#39;,e(u),&#39;&amp;title=&#39;,e(t||d.title),&#39;&amp;source=&#39;,e(r),&#39;&amp;sourceUrl=&#39;,e(l),&#39;&amp;content=&#39;,c||&#39;gb2312&#39;,&#39;&amp;pic=&#39;,e(p||&#39;&#39;)].join(&#39;&#39;);function%20a(){if(!window.open([f,p].join(&#39;&#39;),&#39;mb&#39;,[&#39;toolbar=0,status=0,resizable=1,width=440,height=430,left=&#39;,(s.width-440)/2,&#39;,top=&#39;,(s.height-430)/2].join(&#39;&#39;)))u.href=[f,p].join(&#39;&#39;);};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,&#39;&#39;,&#39;&#39;,&#39;http://cwb.assets.jianshu.io/notes/images/3293451/weibo/image_08afaaf98e0c.jpg&#39;, &#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》（ 分享自 @简书 ）&#39;,&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;,&#39;页面编码gb2312|utf-8默认gb2312&#39;));" data-name="weibo">
            <i class="fa fa-weibo"></i><span>分享到微博</span>
          </a>
          <a data-toggle="modal" href="http://www.jianshu.com/p/cc2281b1a6bc#share-weixin-modal" data-name="weixin">
            <i class="fa fa-weixin"></i><span>分享到微信</span>
          </a>
          <div class="more">
            <a href="javascript:void(0)" data-toggle="dropdown">更多分享<i class="fa fa-caret-down"></i></a>
            <ul class="dropdown-menu arrow-top">
                <li><a href="http://cwb.assets.jianshu.io/notes/images/3293451/weibo/image_08afaaf98e0c.jpg" target="_blank" data-name="changweibo"><i class="fa fa-arrow-circle-o-down"></i> 下载长微博图片</a></li>
                <li>
                  <a data-name="tweibo" href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》（ 分享自 @jianshuio ）&#39;),x=function(){if(!window.open(r,&#39;tweibo&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();">
                    <img src="./LinkedBlockingQueue源码分析 - 简书_files/tweibo.png" alt="Tweibo"> 分享到腾讯微博
</a>                </li>
                <li>
                  <a data-name="qzone" href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》&#39;),x=function(){if(!window.open(r,&#39;qzone&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();">
                    <img src="./LinkedBlockingQueue源码分析 - 简书_files/qzone.png" alt="Qzone"> 分享到QQ空间
</a>                </li>
                <li>
                  <a data-name="twitter" href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://twitter.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;text=&#39;+e(&#39;推荐 码农一枚 的文章《 LinkedBlockingQueue源码分析》（ 分享自 @jianshucom ）&#39;)+&#39;&amp;related=&#39;+e(&#39;jianshucom&#39;),x=function(){if(!window.open(r,&#39;twitter&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();">
                    <img src="./LinkedBlockingQueue源码分析 - 简书_files/twitter.png" alt="Twitter"> 分享到Twitter
</a>                </li>
                <li>
                  <a data-name="facebook" href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://www.facebook.com/dialog/share?app_id=483126645039390&amp;display=popup&amp;href=http://www.jianshu.com/p/cc2281b1a6bc&#39;,x=function(){if(!window.open(r,&#39;facebook&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();">
                    <img src="./LinkedBlockingQueue源码分析 - 简书_files/facebook.png" alt="Facebook"> 分享到Facebook
</a>                </li>
                <li>
                  <a data-name="google_plus" href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://plus.google.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;),x=function(){if(!window.open(r,&#39;google_plus&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();">
                    <img src="./LinkedBlockingQueue源码分析 - 简书_files/google_plus.png" alt="Google plus"> 分享到Google+
</a>                </li>
                <li>
                  <a data-name="douban" href="javascript:void(function(){var d=document,e=encodeURIComponent,s1=window.getSelection,s2=d.getSelection,s3=d.selection,s=s1?s1():s2?s2():s3?s3.createRange().text:&#39;&#39;,r=&#39;http://www.douban.com/recommend/?url=&#39;+e(&#39;http://www.jianshu.com/p/cc2281b1a6bc&#39;)+&#39;&amp;title=&#39;+e(&#39; LinkedBlockingQueue源码分析&#39;)+&#39;&amp;sel=&#39;+e(s)+&#39;&amp;v=1&#39;,x=function(){if(!window.open(r,&#39;douban&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r+&#39;&amp;r=1&#39;};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})()">
                    <img src="./LinkedBlockingQueue源码分析 - 简书_files/douban.png" alt="Douban"> 分享到豆瓣
</a>                </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Modals -->
      <div id="share-weixin-modal" class="modal hide fade share-weixin-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
  </div>
  <div class="modal-body" title="http://www.jianshu.com/p/cc2281b1a6bc?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=weixin">
    <h5>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</h5>
  <canvas width="170" height="170" style="display: none;"></canvas><img src="data:image/png;base64,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" style="display: block;"></div>
</div>

      
      <div id="notebooks-menu" class="panel notebooks-menu arrow-top modal hide fade"><img class="loader-tiny" src="./LinkedBlockingQueue源码分析 - 简书_files/tiny.gif" alt="Tiny"></div>
      <div id="collection-menu" class="panel collection-menu arrow-top modal hide fade"><img class="loader-tiny" src="./LinkedBlockingQueue源码分析 - 简书_files/tiny.gif" alt="Tiny"></div>
      
      <div id="likes-modal" class="modal modal_new support_list-modal fullscreen hide fade" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3>喜欢的用户</h3>
      </div>
      <div class="modal-body">
        <ul class="unstyled users">
        <li data-user-id="1714462"> <a class="avatar" href="http://www.jianshu.com/users/07338322a397"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/9a946b733535"> </a> <a class="blue-link" href="http://www.jianshu.com/users/07338322a397">壞孩子</a> <span class="time">2016.03.30 01:30</span></li><li data-user-id="632348"> <a class="avatar" href="http://www.jianshu.com/users/377ac6a83a2a"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/2e254a782066.jpg"> </a> <a class="blue-link" href="http://www.jianshu.com/users/377ac6a83a2a">疯狂特洛伊</a> <span class="time">2016.03.20 08:01</span></li><li data-user-id="1305462"> <a class="avatar" href="http://www.jianshu.com/users/72cea5a9f9a2"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/a64219d01e58"> </a> <a class="blue-link" href="http://www.jianshu.com/users/72cea5a9f9a2">下一页会是幸福吗</a> <span class="time">2016.03.20 01:06</span></li><li data-user-id="1674602"> <a class="avatar" href="http://www.jianshu.com/users/3235a6007382"> <img src="./LinkedBlockingQueue源码分析 - 简书_files/cf2ca9cf3c06"> </a> <a class="blue-link" href="http://www.jianshu.com/users/3235a6007382">只为朝阳初现</a> <span class="time">2016.03.19 15:02</span></li></ul>
      </div>
    </div>
  </div>
</div>



    <!-- Comments -->
    <div id="comments" class="comment-list clearfix">
        <div class="comment-head clearfix">
          0条评论
          <span class="order">
            （
            <a data-order="asc" class="active" href="javascript:void(0)">按时间正序</a>·
            <a data-order="desc" href="javascript:void(0)">按时间倒序</a>·
            <a data-order="likes_count" href="javascript:void(0)">按喜欢排序</a>
            ）
          </span>
            <a class="goto-comment pull-right" data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in">
              <i class="fa fa-pencil"></i>添加新评论
</a>        </div>
        <div id="comment-list">



  <p class="load-more">没有更多评论了</p>
</div>
          <p class="signout-comment">
    <a class="btn btn-info" data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in">
      登录后发表评论
</a>  </p>

    </div>
    <!-- -->

  </div>

  <script type="application/json" data-name="note">
    {"id":3293451,"abbr":"前言在前面的文章ArrayBlockingQueue源码分析中，已经对JDK中的BlockingQueue中的做了一个回顾，同时对ArrayBlockingQueue中的核心方法作了说明，而LinkedBlockingQueue作为JDK中BlockingQueue家族系列中一员，由于其作为固定大小线程池(Executors.newFixedThreadPool())底层所使用的阻塞队列，分析它的目的主要在于2点：(1)与ArrayBlockingQueue进行类比学习，加深各种数据结构的理解(2)了解底层实现，能够更好地理解每一种阻塞队列对线程池性能的影响，做到真正的...","slug":"cc2281b1a6bc","url":"http://www.jianshu.com/p/cc2281b1a6bc","image_url":"http://cwb.assets.jianshu.io/notes/images/3293451/weibo/image_08afaaf98e0c.jpg","wordage":3958,"has_further_readings":false,"views_count":399,"likes_count":4,"comments_count":0,"rewards_total_count":0}
  </script>

  <script type="application/json" data-name="uuid">
    {"uuid":"b604734d-e57f-42ed-9d8f-537affb251e4"}
  </script>

  <script type="application/json" data-name="author">
    {"id":1684370,"nickname":"码农一枚","slug":"dc9be3b69337","public_notes_count":9,"followers_count":110,"total_likes_count":97,"is_current_user":false,"is_signed_author":false}
  </script>


  <div class="include-collection">
    <div class="content">

      
        <h5>被以下专题收入，发现更多相似内容：</h5>
        <ul id="all-collections" class="unstyled collections-list">
            <li>
              <a class="avatar" href="http://www.jianshu.com/collection/NEt52a"><img src="./LinkedBlockingQueue源码分析 - 简书_files/computer_guy.jpg" alt="180"></a>              <div class="collections-info">
                <h5>
                  <a href="http://www.jianshu.com/collection/NEt52a">程序员</a>
                </h5>
                
  <div class="btn btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in"><i class="fa fa-fw fa-plus"></i>  <span>添加关注</span></a>
    <span>254.5K</span>
  </div>

                <p class="description">如果你是程序员，或者有一颗喜欢写程序的心，喜欢分享技术干货、项目经验、程序员日常囧事等等，欢迎投稿《程序员》专题。

专题主编：小...</p>
                <p>
                  <a class="blue-link" href="http://www.jianshu.com/collection/NEt52a">30046篇文章</a> · 254597人关注
                </p>
              </div>
            </li>
            <li>
              <a class="avatar" href="http://www.jianshu.com/collection/bDHhpK"><img src="./LinkedBlockingQueue源码分析 - 简书_files/首页投稿.png" alt="180"></a>              <div class="collections-info">
                <h5>
                  <a href="http://www.jianshu.com/collection/bDHhpK">首页投稿</a>
                </h5>
                
  <div class="btn btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="http://www.jianshu.com/sign_in"><i class="fa fa-fw fa-plus"></i>  <span>添加关注</span></a>
    <span>145.4K</span>
  </div>

                <p class="description">玩转简书的第一步，从这个专题开始。

想上首页热门榜么？好内容想被更多人看到么？来投稿吧！如果被拒也不要灰心哦～入选文章会进一个队...</p>
                <p>
                  <a class="blue-link" href="http://www.jianshu.com/collection/bDHhpK">123226篇文章</a> · 145471人关注
                </p>
              </div>
            </li>
        </ul>
    </div>
  </div>

  <!-- Modal -->
    <div class="modal pay-modal text-center hide fade" id="pay-modal">
  <div class="modal-header clearfix">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
  </div>
  <form id="new_reward" class="new_reward" target="_blank" action="http://www.jianshu.com/notes/3293451/rewards" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="GHYUmGlOhcMhfn8GPR18ZRNJj60fGxz051Ky7Pqw/uGhsexVTd1zxS+gLq/YypeKNb2dD/oU1tOIM16mXl4peg==">
    <div class="modal-body">
      <a href="http://www.jianshu.com/users/dc9be3b69337">
        <div class="avatar"><img src="./LinkedBlockingQueue源码分析 - 简书_files/675ca95f25be.png" alt="100"></div>
</a>      <p><i class="fa fa-quote-left pull-left"></i>如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作！<i class="fa fa-quote-right pull-right"></i></p>
      <div class="main-inputs text-left">
        <div class="control-group">
          <label for="reward_amount">打赏金额</label><i class="fa fa-yen"></i>
          <input value="2.00" type="text" name="reward[amount_in_yuan]" id="reward_amount_in_yuan">
        </div>
        <div class="control-group message">
          <textarea placeholder="给Ta留言" name="reward[message]" id="reward_message"></textarea>
        </div>
      </div>
      <div class="choose-pay text-left">
        <h5>选择支付方式：</h5>
        <div>
          <label for="reward_channel_alipay">
            <div class="iradio_minimal checked" style="position: relative;"><input type="radio" value="alipay" checked="checked" name="reward[channel]" id="reward_channel_alipay" style="position: absolute; opacity: 0;"><ins class="iCheck-helper" style="position: absolute; top: 0%; left: 0%; display: block; width: 100%; height: 100%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;"></ins></div>
            <span class="alipay-bg"></span>
</label>
          
          <label for="reward_channel_wx_pub_qr">
            <div class="iradio_minimal" style="position: relative;"><input type="radio" value="wx_pub_qr" name="reward[channel]" id="reward_channel_wx_pub_qr" style="position: absolute; opacity: 0;"><ins class="iCheck-helper" style="position: absolute; top: 0%; left: 0%; display: block; width: 100%; height: 100%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;"></ins></div>
            微信支付
</label>        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button name="button" type="submit" class="btn btn-large btn-pay">立即支付</button>
    </div>
</form></div>

    <div class="modal success-pay text-center hide fade" id="success-pay">
  <div class="modal-header clearfix">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
  </div>
  <div class="modal-body">
    <h3><i class="icon-ok"></i>打赏成功</h3>
    <img src="./LinkedBlockingQueue源码分析 - 简书_files/complete-pay-25426877089eb23bd76d9d0e6aad89c1.png" alt="Complete pay">
  </div>
  <div class="modal-footer">
    
  </div>
</div>

</div>

  <div class="imagebubble-backmask image-package" style="z-index: 1000;"><div class="image-caption">LinkedBlockingQueue出队列大致过程.png</div><img class="imagebubble-ghost" src="./LinkedBlockingQueue源码分析 - 简书_files/1684370-9bea30e290a8822c(1).png" style="top: 8277px; left: 556.5px; width: 620px; height: 248px;"></div></div>
  <div id="flash" class="hide"></div>
  
  <div id="view-mode-modal" tabindex="-1" class="modal hide read-modal" aria-hidden="false" data-js-module="view-mode-modal">
    <div class="btn-group change-background" data-toggle="buttons-radio">
      <a class="btn btn-daytime active" data-mode="day" href="javascript:void(null);">
        <i class="fa fa-sun-o"></i>
</a>      <a class="btn btn-nighttime " data-mode="night" href="javascript:void(null);">
        <i class="fa fa-moon-o"></i>
</a>    </div>
    <div class="btn-group change-font" data-toggle="buttons-radio">
      <a class="btn font " data-font="font1" href="javascript:void(null);">宋体</a>
      <a class="btn font hei active" data-font="font2" href="javascript:void(null);">黑体</a>
    </div>
    <div class="btn-group change-locale" data-toggle="buttons-radio">
      <a class="btn font active" data-locale="zh-CN" href="javascript:void(null);">简</a>
      <a class="btn font hei " data-locale="zh-TW" href="javascript:void(null);">繁</a>
    </div>
  </div>

  

  <script src="./LinkedBlockingQueue源码分析 - 简书_files/base-90f2ea0f7da77d330f3fe2acdcf5d595.js.download"></script>
  
  <script src="./LinkedBlockingQueue源码分析 - 简书_files/reading-base-0028299ec0c770293c0f07e2f338b48f.js.download"></script>
  <script src="./LinkedBlockingQueue源码分析 - 简书_files/note_show-cc5c20512664aad53acca20308dd4d1c.js.download"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-35169517-1', 'auto');
  ga('send', 'pageview');
</script>

<div style="display:none">
  <script src="./LinkedBlockingQueue源码分析 - 简书_files/z_stat.php" language="JavaScript"></script><script src="./LinkedBlockingQueue源码分析 - 简书_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=1258679142" target="_blank" title="站长统计">站长统计</a>
</div>

<script>
  (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
</script>



</body></html>